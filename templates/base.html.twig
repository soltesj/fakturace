<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Welcome!{% endblock %}</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <script>
        window.serverTheme = "{{ app.user.setting.theme|default('') }}";
        (() => {
            try {
                const localTheme = localStorage.getItem('theme');
                const serverTheme = window.serverTheme;
                document.documentElement.className = '';
                if (localTheme) {
                    document.documentElement.classList.add(serverTheme);
                    localStorage.setItem('theme', serverTheme);
                } else if (localTheme) {
                    document.documentElement.classList.add(localTheme);
                } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.add('light');
                }
            } catch (_) {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>
    {% block stylesheets %}
        {{ encore_entry_link_tags('app') }}
    {% endblock %}

    {% block javascripts %}
        {{ encore_entry_script_tags('app') }}
        {% block importmap %}{% endblock %}
    {% endblock %}
</head>
<body class="bg-background text-secondary transition-colors duration-300">


{% if app.user and company|default(null) %}
    {% include 'header-user.html.twig' %}
{% else %}
    {% include 'header.html.twig' %}
{% endif %}
<div class="max-w-7xl mx-auto md:px-4 py-4 pb-32 md:py-4 px-0">
    {% for label, messages in app.flashes %}
        {% for message in messages %}
            <div class="mb-8 rounded border-l-4 p-4 delay-75  transition-opacity opacity-100 duration-900
            {% if label == 'info' %}
                    border-blue-500 bg-blue-100 text-blue-800 text-white/80 hover:text-white/90
                {% elseif label == 'success' %}
                    border-green-500 bg-success-text text-green-800  text-white/80 hover:text-white/90
                {% elseif label == 'error' %}
                    border-red-500 bg-red-100   text-white/80 hover:text-white/90
                {% elseif label == 'warning' %}
                    border-yellow-500 bg-yellow-100 text-yellow-800  text-white/80 hover:text-white/90
                {% else %}
                    border-gray-500 bg-gray-100 text-gray-800  text-white/80 hover:text-white/90
                {% endif %}
            ">
                {{ message|trans }}
            </div>
        {% endfor %}
    {% endfor %}

    {% block body %}{% endblock %}
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('toggle-theme')?.addEventListener('click', () => {
            let theme = localStorage.getItem('theme')

            document.documentElement.className = '';
            theme = theme !== 'dark' ? 'dark' : 'light';
            localStorage.setItem('theme', theme)
            document.documentElement.classList.add(theme)
            console.log(theme)
            fetch('/api/user/theme', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({theme: theme})
            });
        })
    })
</script>
{% include 'svg-symbols.html.twig' %}
</body>
</html>